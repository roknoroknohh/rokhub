#!/bin/bash

# ============================================
# ุณูุฑุจุช ุชุดุบูู ROKhub - ููุตุฉ ุงูุฃูุนุงุจ ุงูุฑูููุฉ
# ============================================

# ุงูุฃููุงู ููุทุจุงุนุฉ
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ        ๐ฎ ROKhub - Gaming Platform       โ"
echo "โ         ููุตุฉ ุงูุฃูุนุงุจ ุงูุฑูููุฉ             โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo -e "${NC}"

# ุงูุชุญูู ูู Python
if ! command -v python3 &> /dev/null; then
    echo -e "${RED}โ Python3 ุบูุฑ ูุซุจุช!${NC}"
    exit 1
fi

# ุงูุชุญูู ูู ูุฌูุฏ ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
if [ ! -d "venv" ]; then
    echo -e "${YELLOW}โ๏ธ  ุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ...${NC}"
    python3 -m venv venv
fi

# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
echo -e "${BLUE}๐ ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ...${NC}"
source venv/bin/activate

# ุชุซุจูุช ุงููุชุทูุจุงุช
echo -e "${BLUE}๐ฆ ุชุซุจูุช ุงููุชุทูุจุงุช...${NC}"
pip install -q -r requirements.txt

# ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
if [ ! -f "instance/rokhub.db" ]; then
    echo -e "${YELLOW}๐๏ธ  ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช...${NC}"
    python3 -c "
from app import app
from utils import init_database
with app.app_context():
    init_database()
    print('โ ุชู ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ!')
"
fi

# ุนุฑุถ ุงููุนูููุงุช
echo ""
echo -e "${GREEN}โ ุฌุงูุฒ ููุชุดุบูู!${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "๐ ุงููููุน: ${GREEN}http://localhost:5000${NC}"
echo -e "๐ง ููุญุฉ ุงูุชุญูู: ${GREEN}http://localhost:5000/admin${NC}"
echo -e "๐๏ธ  ูุงุนุฏุฉ ุงูุจูุงูุงุช: ${YELLOW}instance/rokhub.db${NC}"
echo -e "๐ ุงูุณุฌูุงุช: ${YELLOW}app.log${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${YELLOW}ุงุถุบุท Ctrl+C ููุฅููุงู${NC}"
echo ""

# ุชุดุบูู ุงูุชุทุจูู
python3 app.py
